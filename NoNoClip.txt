local player = game.Players.LocalPlayer
local character = player.Character or player.CharacterAdded:Wait()
local humanoid = character:WaitForChild("Humanoid")

-- Enable collisions on all parts to turn noclip off
for _, part in pairs(character:GetDescendants()) do
    if part:IsA("BasePart") then
        part.CanCollide = true
    end
end

-- Reset Humanoid properties if changed by noclip
humanoid.PlatformStand = false
humanoid:SetStateEnabled(Enum.HumanoidStateType.Freefall, true)
humanoid:SetStateEnabled(Enum.HumanoidStateType.FallingDown, true)

-- Optional: If you have any BodyVelocity or BodyGyro used for flying/noclip, destroy them
local rootPart = character:FindFirstChild("HumanoidRootPart")
if rootPart then
    for _, child in pairs(rootPart:GetChildren()) do
        if child:IsA("BodyVelocity") or child:IsA("BodyGyro") then
            child:Destroy()
        end
    end
end
